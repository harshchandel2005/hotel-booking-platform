<%- layout('layouts/boilerplate.ejs') %>

<div class="container mt-4">
  <h2>Available Listings (<%= allData.length %>)</h2>
  
  <div class="row">
    <% for(let data of allData) { %>
      <div class="col-12 col-sm-12 col-md-4 col-lg-3 mb-4">
        <a href="/listings/<%= data._id %>" style="text-decoration: none; color: inherit;">
          <div class="card h-100 shadow-sm">
            <img loading="lazy" data-src="<%= data.image.url %>" class="card-img-top listing-image" alt="<%= data.title %>" style="height: 200px; object-fit: cover; background-color: #f0f0f0;">
            <div class="card-body">
              <h5 class="card-title"><%= data.title %></h5>     
              <p class="card-text">Price: &#8377; <%= data.price %>/night</p>
              <small class="text-muted"><%= data.location %></small>
            </div>
          </div>
        </a>
      </div>
    <% } %>
  </div>
</div>

<script>
  // Lazy load images
  document.addEventListener('DOMContentLoaded', function() {
    const images = document.querySelectorAll('img[data-src]');
    
    if ('IntersectionObserver' in window) {
      const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            img.src = img.dataset.src;
            img.removeAttribute('data-src');
            imageObserver.unobserve(img);
          }
        });
      });
      
      images.forEach(img => imageObserver.observe(img));
    } else {
      // Fallback for older browsers
      images.forEach(img => {
        img.src = img.dataset.src;
      });
    }
  });
</script>






<div class="container mt-4">
  <div class="row" id="searchResults">
    <% allData.forEach(data => { %>
      <div class="col-md-4">
        <div class="card property-card">
          <div class="card-body">
            <!-- other listing details -->
          </div>
        </div>
      </div>
    <% }); %>
  </div>
</div>

<!-- Include the search JS at the bottom -->








<script>
  let tax_toggle = document.getElementById('switchCheckDefault');
  tax_toggle.addEventListener('change', function() {
   let taxInfo = document.getElementsByClassName("tax-info");
   for(info of taxInfo){
    if(info.style.display != "inline"){
    info.style.display ="inline";
   }
   else{
    info.style.display ="none";
   }
  }
  });   
</script>
<script src="/js/search.js"></script>

